<button class="btn" id="theme-toggle" type="button" aria-label="Toggle dark mode">
  Dark
</button>

<script>
  const btn = document.currentScript?.previousElementSibling;
  if (btn) {
    const apply = (mode) => {
      if (mode === 'dark') {
        document.documentElement.dataset.theme = 'dark';
        btn.textContent = 'Light';
      } else {
        document.documentElement.removeAttribute('data-theme');
        btn.textContent = 'Dark';
      }
    };

    // init
    const pref = localStorage.getItem('theme');
    if (pref) apply(pref);
    else apply(window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');

    btn.addEventListener('click', () => {
      const isDark = document.documentElement.dataset.theme === 'dark';
      const next = isDark ? 'light' : 'dark';
      try { localStorage.setItem('theme', next); } catch {}
      apply(next);
    });
  }
</script>
