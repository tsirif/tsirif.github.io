<button class="btn" id="theme-toggle" type="button" aria-label="Toggle color scheme">Dark</button>
<script is:inline>
  (()=>{
    const btn = document.getElementById('theme-toggle');
    if (!btn) return;

    // Just set the label to match current DOM state; do NOT write to localStorage here.
    const syncLabel = () => {
      const dark = document.documentElement.dataset.theme === 'dark';
      btn.textContent = dark ? 'Light' : 'Dark'; // show the action
    };
    syncLabel();

    btn.addEventListener('click', () => {
      const next = document.documentElement.dataset.theme === 'dark' ? 'light' : 'dark';
      document.documentElement.dataset.theme = next;
      try { localStorage.setItem('theme', next); } catch {}
      window.dispatchEvent(new CustomEvent('theme-change', { detail: next }));
      syncLabel();
    });

    // Optional: if you ever enable view transitions or partial reloads,
    // re-sync label after swap:
    window.addEventListener?.('astro:after-swap', syncLabel);
  })();
</script>
